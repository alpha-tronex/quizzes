<section class="masthead bg-primary text-white text-center">
  <!-- Quiz Questions View -->
  <div class="container" *ngIf="curQuestion && !submitted">
    <h2 class="mb-2">Quiz</h2>
    <h2 class="mb-4">{{ quiz.title }}</h2>
    
    <div class="card text-dark">
      <div class="card-body">
        <div class="text-start">
          <h5 class="question text-left mb-4">{{curQuestion.question}}</h5>
          <p class="instructions text-muted text-start mb-4">{{curQuestion.instructions}}</p>
          
          <div class="form-group">
            <ng-template [ngIf]="this.multichoice">
              <div class="d-flex align-items-center mb-3" *ngFor="let answer of curQuestion.answers; let i = index">
                <div class="flex-grow-1 me-3">
                  <input type="text" class="form-control" [value]="answer" style="max-width: 99%;" disabled>
                </div>
                <div class="d-flex align-items-center justify-content-center" style="width: 2rem;">
                  <input type="checkbox" class="form-check-input m-0" style="width: 1.5rem; height: 1.5rem;" 
                    [checked]="isAnswerSelected(i + 1)" (change)="recordMultiChoiceAnswer(i + 1)">
                </div>
              </div>
            </ng-template>
            
            <ng-template [ngIf]="this.onechoice">
              <div class="d-flex align-items-center mb-3" *ngFor="let answer of curQuestion.answers; let i = index">
                <div class="flex-grow-1 me-3">
                  <input type="text" class="form-control" [value]="answer" style="max-width: 99%;" disabled>
                </div>
                <div class="d-flex align-items-center justify-content-center" style="width: 2rem;">
                  <input type="radio" name="answer" class="form-check-input m-0" style="width: 1.5rem; height: 1.5rem;" 
                    [checked]="isAnswerSelected(i + 1)" (change)="recordSingleAnswer(i + 1)">
                </div>
              </div>
            </ng-template>
            
            <ng-template [ngIf]="this.truefalse">
              <div class="d-flex align-items-center mb-3" *ngFor="let answer of curQuestion.answers; let i = index">
                <div class="flex-grow-1 me-3">
                  <input type="text" class="form-control" [value]="answer" style="max-width: 99%;" disabled>
                </div>
                <div class="d-flex align-items-center justify-content-center" style="width: 2rem;">
                  <input type="radio" name="answer" class="form-check-input m-0" style="width: 1.5rem; height: 1.5rem;" 
                    [checked]="isAnswerSelected(i + 1)" (change)="recordSingleAnswer(i + 1)">
                </div>
              </div>
            </ng-template>
            
            <div class="row mt-5">
              <div class="col-sm-4">
                <button class="btn btn-secondary w-100" (click)="goPrevious()"
                  style="max-width: 99%; margin-bottom: 5px;" [disabled]="this.curQuestion.questionNum === 0">Previous</button>
              </div>
              <div class="col-sm-4">
                <button class="btn btn-primary w-100" style="margin-bottom: 5px;" (click)="submit()" [disabled]="!allAnswered">Submit</button>
              </div>
              <div class="col-sm-4">
                <button class="btn btn-secondary w-100" (click)="goNext()"
                  style="max-width: 99%;" [disabled]="this.quiz.questions.length === (this.curQuestion.questionNum + 1)">Next</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Quiz Results View -->
  <div class="container" *ngIf="submitted">
    <h2 class="mb-4">Quiz Results</h2>
    <h3 class="mb-5">{{ quiz.title }}</h3>
    
    <div class="card text-dark mb-4" *ngFor="let question of quiz.questions; let i = index">
      <div class="card-body">
        <div class="text-start">
          <h5 class="mb-4 text-left"><strong>Question {{i + 1}}:</strong> {{question.question}}</h5>
          
          <div class="mb-3 text-left">
            <strong>Your Selection(s):</strong>
            <p class="mt-2 mb-0">
              <span *ngFor="let selection of question.selection; let last = last">
                {{getAnswerText(question, selection)}}<span *ngIf="!last">, </span>
              </span>
            </p>
          </div>
          
          <div class="alert alert-success mb-3 text-left">
            <strong>Correct Answer(s):</strong>
            <p class="mt-2 mb-0">
              <span *ngFor="let correct of question.correct; let last = last">
                {{getAnswerText(question, correct)}}<span *ngIf="!last">, </span>
              </span>
            </p>
          </div>
          
          <div class="text-left">
            <strong>Result:</strong>
            <p class="mt-2 mb-0" [ngClass]="isQuestionCorrect(question) ? 'text-success' : 'text-danger'">
              <strong *ngIf="isQuestionCorrect(question)">✓ Correct</strong>
              <strong *ngIf="!isQuestionCorrect(question)">✗ Incorrect</strong>
            </p>
          </div>
        </div>
      </div>
    </div>
    
    <div class="row mt-4">
      <div class="col-sm-6">
        <button class="btn btn-secondary w-100" style=" margin-bottom: 5px;" (click)="retakeQuiz()" [disabled]="resultsAccepted">Retake Quiz</button>
      </div>
      <div class="col-sm-6">
        <button class="btn btn-secondary w-100" (click)="acceptResults()" [disabled]="resultsAccepted">Accept Results</button>
      </div>
    </div>
  </div>
  
  <div class="container" *ngIf="!curQuestion && !submitted">
    <div class="alert alert-warning">
      <p class="mb-0">Please check again later. Thanks.</p>
    </div>
  </div>
</section>